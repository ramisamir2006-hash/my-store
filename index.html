<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Ù…ØªØ¬Ø± Ø±Ø§Ù…ÙŠ Ø³Ù…ÙŠØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ</title>
    <style>
        :root { --main-gold: #D4AF37; --dark-bg: #1a1a1a; --text-white: #ffffff; }
        body { font-family: 'Cairo', sans-serif; background: var(--dark-bg); color: var(--text-white); margin: 0; padding-bottom: 80px; }
        .header { background: linear-gradient(45deg, #000, #444); padding: 20px; text-align: center; border-bottom: 2px solid var(--main-gold); }
        .category-bar { display: flex; overflow-x: auto; padding: 10px; gap: 10px; background: #222; }
        .cat-btn { background: none; border: 1px solid var(--main-gold); color: gold; padding: 5px 15px; border-radius: 20px; white-space: nowrap; }
        
        /* ÙƒØ±ÙˆØª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .products-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .product-card { background: #282828; border-radius: 12px; overflow: hidden; border: 1px solid #333; position: relative; }
        .product-img { width: 100%; height: 150px; background: #444; object-fit: cover; }
        .product-info { padding: 10px; text-align: center; }
        .price { color: var(--main-gold); font-weight: bold; font-size: 1.2em; }
        
        /* Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª ÙˆÙ†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„ */
        .size-selector { margin: 5px 0; font-size: 0.8em; }
        .buy-btn { background: var(--main-gold); border: none; width: 100%; padding: 8px; font-weight: bold; cursor: pointer; }

        /* Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆÙ„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .cart-panel, .admin-panel { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--dark-bg); z-index: 1000; display: none; overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .form-group { margin-bottom: 15px; }
        input, select, textarea { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--main-gold); background: #333; color: #fff; box-sizing: border-box; }
        
        .footer-nav { position: fixed; bottom: 0; width: 100%; background: #000; display: flex; justify-content: space-around; padding: 10px 0; border-top: 2px solid var(--main-gold); }
        .nav-item { color: #fff; text-decoration: none; font-size: 0.8em; text-align: center; cursor: pointer;}
        .hidden { display: none; }
        .show { display: block; }
    </style>
</head>
<body>

<div class="header">
    <h2>âœ¨ Ù…Ù€Ø¬Ù€ÙˆÙ‡Ø±Ø§Øª Ø±Ø§Ù…Ù€ÙŠ Ø³Ù€Ù…Ù€ÙŠÙ€Ø± âœ¨</h2>
    <div id="userTypeBadge" style="color: gold; font-size: 0.9em;">Ø­Ø³Ø§Ø¨: Ø¹Ù…ÙŠÙ„ ØªØ¬Ø²Ø¦Ø©</div>
</div>

<div class="category-bar" id="cats">
    <button class="cat-btn" onclick="filterCat('Ø§Ù„ÙƒÙ„')">Ø§Ù„ÙƒÙ„</button>
    <button class="cat-btn" onclick="filterCat('ØºÙˆØ§ÙŠØ´')">ØºÙˆØ§ÙŠØ´</button>
    <button class="cat-btn" onclick="filterCat('Ø®ÙˆØ§ØªÙ…')">Ø®ÙˆØ§ØªÙ…</button>
    <button class="cat-btn" onclick="filterCat('Ø³Ù„Ø§Ø³Ù„')">Ø³Ù„Ø§Ø³Ù„</button>
</div>

<div class="products-grid" id="mainGrid">
    </div>

<div id="adminPanel" class="admin-panel">
    <h3>âš™ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
    <div class="form-group">
        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬:</label>
        <input type="text" id="p_name">
    </div>
    <div class="form-group">
        <label>Ø§Ù„Ø³Ø¹Ø±:</label>
        <input type="number" id="p_price">
    </div>
    <div class="form-group">
        <label>Ø§Ù„Ù‚Ø³Ù…:</label>
        <select id="p_cat">
            <option value="ØºÙˆØ§ÙŠØ´">ØºÙˆØ§ÙŠØ´</option>
            <option value="Ø®ÙˆØ§ØªÙ…">Ø®ÙˆØ§ØªÙ…</option>
        </select>
    </div>
    <div class="form-group">
        <label>Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© (ÙÙˆØ§ØµÙ„):</label>
        <input type="text" id="p_sizes" placeholder="Ù…Ø«Ø§Ù„: 60, 62, 64">
    </div>
    <button class="buy-btn" onclick="saveProduct(true)">Ø­ÙØ¸ ÙˆÙ†Ø´Ø± ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© ğŸ“¢</button>
    <br><br>
    <button class="buy-btn" style="background: red;" onclick="closePanels()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="cartPanel" class="cart-panel">
    <h3>ğŸ›’ Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</h3>
    <div class="form-group">
        <input type="text" id="cust_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
    </div>
    <div class="form-group">
        <input type="tel" id="cust_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    </div>
    <div class="form-group">
        <textarea id="cust_addr" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„"></textarea>
    </div>
    <div class="form-group">
        <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</label>
        <select id="ship_type">
            <option value="delivery">Ø´Ø­Ù† Ù„Ù„Ù…Ù†Ø²Ù„</option>
            <option value="pickup">Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø­Ù„</option>
        </select>
    </div>
    <div class="form-group">
        <label>Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…ÙØ¶Ù‘Ù„:</label>
        <input type="datetime-local" id="ship_time">
    </div>
    <div id="orderSummary"></div>
    <button class="buy-btn" style="background: #28a745;" onclick="confirmOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø± ğŸš€</button>
</div>

<div class="footer-nav">
    <div class="nav-item" onclick="showPanel('main')">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
    <div class="nav-item" onclick="showPanel('cart')">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</div>
    <div class="nav-item" id="adminTab" onclick="showPanel('admin')" style="display: none;">âš™ï¸ Ø§Ù„Ù…Ø¯ÙŠØ±</div>
</div>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand();

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±
    const isAdmin = tg.initDataUnsafe.user?.id === 7020070481;
    if(isAdmin) document.getElementById('adminTab').style.display = 'block';

    let cart = [];
    let products = JSON.parse(localStorage.getItem('my_db')) || [
        {id:1, name: 'ØºÙˆÙŠØ´Ø© ÙƒÙ„ÙŠÙˆØ¨Ø§ØªØ±Ø§', price: 5000, cat: 'ØºÙˆØ§ÙŠØ´', sizes: '60,62', img: ''},
        {id:2, name: 'Ø®Ø§ØªÙ… Ø³ÙˆÙ„ÙŠØªÙŠØ±', price: 3500, cat: 'Ø®ÙˆØ§ØªÙ…', sizes: '18,19', img: ''}
    ];

    function renderProducts() {
        let html = '';
        products.forEach(p => {
            html += `
                <div class="product-card">
                    <div class="product-img"></div>
                    <div class="product-info">
                        <div class="product-name">${p.name}</div>
                        <div class="price">${p.price} Ø¬.Ù…</div>
                        <select class="size-selector" id="size_${p.id}">
                            ${p.sizes.split(',').map(s => `<option>${s}</option>`).join('')}
                        </select>
                        <button class="buy-btn" onclick="addToCart(${p.id})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
                    </div>
                </div>
            `;
        });
        document.getElementById('mainGrid').innerHTML = html;
    }

    function addToCart(id) {
        let p = products.find(i => i.id === id);
        let selectedSize = document.getElementById('size_'+id).value;
        cart.push({...p, selectedSize});
        tg.showPopup({message: "ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©"});
    }

    function showPanel(type) {
        closePanels();
        if(type === 'admin') document.getElementById('adminPanel').style.display = 'block';
        if(type === 'cart') {
            document.getElementById('cartPanel').style.display = 'block';
            updateOrderSummary();
        }
    }

    function closePanels() {
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('cartPanel').style.display = 'none';
    }

    function updateOrderSummary() {
        let total = cart.reduce((s, i) => s + i.price, 0);
        document.getElementById('orderSummary').innerHTML = `<h4>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¬.Ù…</h4>`;
    }

    function confirmOrder() {
        let orderData = {
            customer: document.getElementById('cust_name').value,
            phone: document.getElementById('cust_phone').value,
            address: document.getElementById('cust_addr').value,
            type: document.getElementById('ship_type').value,
            time: document.getElementById('ship_time').value,
            items: cart,
            total: cart.reduce((s, i) => s + i.price, 0)
        };
        tg.sendData(JSON.stringify(orderData));
    }

    renderProducts();
</script>
</body>
    </html>
    
