<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± ÙƒØ§Ø±Ø§Ø³ ÙˆØ£Ø¨Ùˆ Ø³ÙŠÙÙŠÙ†</title>
    <style>
        :root { --p: #c2185b; --bg: #f8f9fa; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .prod-card { background: white; border-radius: 10px; text-align: center; padding: 10px; border: 1px solid #ddd; }
        .prod-card img { width: 100%; height: 120px; border-radius: 8px; object-fit: cover; }
        button { background: var(--p); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; width: 100%; margin-top: 5px; }
        .del-btn { background: #dc3545; width: auto; padding: 5px 10px; }
        input, select { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; text-align: center; padding: 10px; background: #eee; border-radius: 10px; cursor: pointer; }
        .active-tab { background: var(--p); color: white; }
    </style>
</head>
<body>

    <h2 style="text-align: center; color: var(--p);">ğŸ’ ÙƒØ§Ø±Ø§Ø³ ÙˆØ£Ø¨Ùˆ Ø³ÙŠÙÙŠÙ† Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯</h2>

    <div class="tabs">
        <div class="tab active-tab" onclick="show('store')">ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</div>
        <div class="tab" onclick="show('cart')">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</div>
        <div class="tab" onclick="show('admin')">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
    </div>

    <div id="store-page">
        <div class="grid" id="product-display"></div>
    </div>

    <div id="cart-page" style="display:none;">
        <div class="card">
            <h3>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h3>
            <div id="cart-items"></div>
            <hr>
            <select id="cust-type">
                <option value="retail">Ù‚Ø·Ø§Ø¹ÙŠ (Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)</option>
                <option value="wholesale">Ø¬Ù…Ù„Ø© (Ø®ØµÙ… Ø®Ø§Øµ Ù„Ù„ØªØ¬Ø§Ø±)</option>
            </select>
            <input type="text" id="cust-name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
            <input type="tel" id="cust-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
            <button onclick="sendOrder()">âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø³ÙŠØ³ØªÙ…</button>
        </div>
    </div>

    <div id="admin-page" style="display:none;">
        <div class="card">
            <h3>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù„Ù„Ù‚Ù†Ø§Ø© ÙˆØ§Ù„Ù…ØªØ¬Ø±</h3>
            <input type="text" id="n" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
            <input type="number" id="p" placeholder="Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø§Ø¹ÙŠ">
            <input type="number" id="w" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø©">
            <input type="text" id="i" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
            <select id="c">
                <option>Ø³Ù„Ø§Ø³Ù„</option>
                <option>Ø®ÙˆØ§ØªÙ…</option>
                <option>Ø§Ù†Ø³ÙŠØ§Ù„Ø§Øª</option>
            </select>
            <button onclick="publishProduct()">ğŸš€ Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
        </div>
    </div>

    <script>
        let cart = [];
        let prods = JSON.parse(localStorage.getItem('prods')) || [];

        function show(page) {
            document.getElementById('store-page').style.display = page === 'store' ? 'block' : 'none';
            document.getElementById('cart-page').style.display = page === 'cart' ? 'block' : 'none';
            document.getElementById('admin-page').style.display = page === 'admin' ? 'block' : 'none';
            if(page === 'store') renderStore();
            if(page === 'cart') renderCart();
        }

        function publishProduct() {
            const data = { name:document.getElementById('n').value, price:document.getElementById('p').value, wholesale:document.getElementById('w').value, image:document.getElementById('i').value, cat:document.getElementById('c').value };
            fetch('/publish', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data) });
            prods.push(data);
            localStorage.setItem('prods', JSON.stringify(prods));
            alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­!");
            show('store');
        }

        function renderStore() {
            document.getElementById('product-display').innerHTML = prods.map((p, idx) => `
                <div class="prod-card">
                    <img src="${p.image}">
                    <h4>${p.name}</h4>
                    <p>${p.price} Ø¬.Ù…</p>
                    <button onclick="addToCart(${idx})">â• Ù„Ù„Ø³Ù„Ø©</button>
                </div>
            `).join('');
        }

        function addToCart(idx) {
            cart.push(prods[idx]);
            alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…");
        }

        function renderCart() {
            document.getElementById('cart-items').innerHTML = cart.map((item, idx) => `
                <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                    <span>${item.name}</span>
                    <button class="del-btn" onclick="removeFromCart(${idx})">âŒ</button>
                </div>
            `).join('');
        }

        function removeFromCart(idx) {
            cart.splice(idx, 1);
            renderCart();
        }

        async function sendOrder() {
            const order = {
                name: document.getElementById('cust-name').value,
                phone: document.getElementById('cust-phone').value,
                customerType: document.getElementById('cust-type').value,
                items: cart,
                total: cart.reduce((s, i) => s + parseFloat(i.price), 0)
            };
            await fetch('/submit-order', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(order) });
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ ÙˆØªØ³Ø¬ÙŠÙ„Ù‡ ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©! Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„Ùƒ Ù…Ø¹Ù†Ø§.");
            cart = [];
            show('store');
        }

        renderStore();
    </script>
</body>
</html>
